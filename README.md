# π› οΈ ν„μ¥ μ‹¤μ „ λ€μ‘ κ°€μ΄λ“

### 0. κΉƒ ν΄λ΅ 
λ ν¬μ§€ν† λ¦¬ μ΄λ¦„μ΄ `kmc_ws`μ΄λ―€λ΅ ν™ λ””λ ‰ν† λ¦¬μ—μ„ λ°”λ΅ ν΄λ΅ ν•λ©΄ κ²½λ΅κ°€ μλ™μΌλ΅ λ§μ¶°μ§‘λ‹λ‹¤.

```bash
cd ~
git clone https://github.com/Iamshy95/kmc_ws.git
```

### 1. ν•λ“μ›¨μ–΄ μ—°κ²° λ° ν¬νΈ ν™•μΈ
μ°¨λ‰ USBλ¥Ό μ—°κ²°ν• ν›„, ν¬νΈ κ¶ν•μ„ λ¶€μ—¬ν•©λ‹λ‹¤.

```bash
# 1. ν¬νΈ ν™•μΈ (λ³΄ν†µ /dev/ttyUSB0 ν™•μΈ)
ls -l /dev/ttyUSB*

# 2. ν¬νΈ κ¶ν• λ¶€μ—¬ (μ½κΈ°/μ“°κΈ° κ¶ν• ν—μ©)
# λΉ„λ°€λ²νΈλ¥Ό λ¬Όμ–΄λ³΄λ©΄ μ…λ ¥ν•μ„Έμ”.
sudo chmod 666 /dev/ttyUSB0
```

### 2. ν†µν•© λΉλ“ (SDK + ROS2)
μ›ν¬μ¤νμ΄μ¤ μµμƒμ„(`~/kmc_ws`)μ—μ„ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•λ©΄ SDKμ™€ ROS ν¨ν‚¤μ§€κ°€ μμ„λ€λ΅ λΉλ“λ©λ‹λ‹¤.

```bash
cd ~/kmc_ws
./src/controller/scripts/build.sh
```

### 3. ν„°λ―Έλ„ ν™κ²½ μ„¤μ •
**λ¨λ“  μƒ ν„°λ―Έλ„**μ„ μ—΄ λ•λ§λ‹¤ λ°λ“μ‹ μ‹¤ν–‰ν•΄μ•Ό ν•©λ‹λ‹¤.

```bash
cd ~/kmc_ws
source src/controller/scripts/env.sh
```

### 4. λ…Έλ“ μ‹¤ν–‰ μμ„ (μ΄ 3κ° ν„°λ―Έλ„)

#### ν„°λ―Έλ„ 1: KMC λ“λΌμ΄λ²„ (C++)
* **ν¬νΈ/ID λ³€κ²½:** λ…λ Ήμ–΄μ μµμ…λ§ μμ •ν•λ©΄ μ¦‰μ‹ λ°μλ©λ‹λ‹¤. (μ¬λΉλ“ λ¶ν•„μ”)
* μ•„λ λ…λ Ήμ–΄μ `car_id:=22`μ™€ `port:=...`λ¥Ό ν„μ¥ μƒν™©μ— λ§κ² λ³€κ²½ν•μ„Έμ”.

```bash
ros2 run kmc_hardware kmc_driver_node --ros-args -p port:=/dev/ttyUSB0 -p car_id:=22
```

#### ν„°λ―Έλ„ 2: RSU μΈν”„λΌ (Python)
* **μ£Όμ:** μ‹¤ν–‰ μ „ μ½”λ“λ¥Ό μ—΄μ–΄ `self.id_map`κ³Ό `self.hv_ids`κ°€ ν„μ¥ μ°¨λ‰κ³Ό μΌμΉν•λ”μ§€ ν™•μΈν•μ„Έμ”.
* `nano` μ—λ””ν„° μ‚¬μ©λ²•: μμ • ν›„ `Ctrl+O` (μ €μ¥) -> `Enter` -> `Ctrl+X` (μΆ…λ£)

```bash
# μ‹¤ν–‰
python3 src/controller/controller/rsu.py
```

#### ν„°λ―Έλ„ 3: μ£Όν–‰ μ μ–΄ (Python)
* **ν•„μ μμ •:** μ‹¤ν–‰ μ „ μ½”λ“λ¥Ό μ—΄μ–΄ `self.car_id = 22`λ¥Ό **ν„μ¬ μ°¨λ‰ λ²νΈ**λ΅ μμ •ν•΄μ•Ό ν•©λ‹λ‹¤.
* **κ²½λ΅ ν™•μΈ:** `path_file` κ²½λ΅κ°€ `path1.csv`μΈμ§€ `path2.csv`μΈμ§€ ν™•μΈν•μ„Έμ”.

```bash
# μ½”λ“ μμ • (Car ID λ° κ²½λ΅ νμΌ ν™•μΈ)
nano src/controller/controller/drive_basic.py
```

```bash
# μ‹¤ν–‰
python3 src/controller/controller/drive_basic.py
```

---

### π¨ λΉ„μƒ λ€μ‘ μ²΄ν¬λ¦¬μ¤νΈ

1.  **κ²½λ΅ μ—λ¬ (`FileNotFoundError`)**
    * ν„μ¬ ν΄λ”κ°€ `~/kmc_ws`μΈμ§€ ν™•μΈν•μ„Έμ” (`pwd` λ…λ Ήμ–΄ μ‚¬μ©).
    * μ½”λ“ λ‚΄μ νμΌ κ²½λ΅(`path1.csv` λ“±)κ°€ μ‹¤μ  νμΌλ…κ³Ό λ€μ†λ¬ΈμκΉμ§€ μΌμΉν•λ”μ§€ ν™•μΈν•μ„Έμ”.

2.  **ν†µμ‹  μ—λ¬ (Open Error / Permission Denied)**
    * λ“λΌμ΄λ²„ λ…Έλ“κ°€ μ‹¤ν–‰λμ§€ μ•μΌλ©΄ `ls -l /dev/ttyUSB*`λ΅ ν¬νΈκ°€ μ—°κ²°λμ–΄ μλ”μ§€ ν™•μΈν•μ„Έμ”.
    * `sudo chmod 666 /dev/ttyUSB0` λ…λ Ήμ–΄λ¥Ό λ‹¤μ‹ μ‹¤ν–‰ν•μ„Έμ”.

3.  **μΆ…λ£ μμ„ (μ•μ „ μ μΌ)**
    * 1μμ„: **[μ£Όν–‰ λ…Έλ“(Py)]** μΆ…λ£ (`Ctrl+C`)
    * 2μμ„: μ°¨λ‰μ΄ μ™„μ „ν λ©μ·„λ”μ§€ λμΌλ΅ ν™•μΈ
    * 3μμ„: **[λ“λΌμ΄λ²„ λ…Έλ“(C++)]** μΆ…λ£